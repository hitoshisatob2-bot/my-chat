<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>kubota WSM aiã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ</title>
    <style>
        body { font-family: sans-serif; margin: 0; background-color: #f5f5f5; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; }
        .container { text-align: center; background: white; padding: 40px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); width: 80%; max-width: 400px; }
        /* ç‹¬è‡ªãƒã‚¤ã‚¯ãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        #voice-btn {
            background: #4285f4; color: white; border: none; border-radius: 50%; width: 50px; height: 50px; 
            font-size: 24px; cursor: pointer; margin-top: 20px; transition: 0.3s;
        }
        #voice-btn.recording { background: #ea4335; transform: scale(1.2); }
    </style>
</head>
<body>

<div class="container" id="welcome-box">
    <h2>kubota WSM aiã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ</h2>
    <p>ä¸‹ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨AIãƒãƒ£ãƒƒãƒˆãŒé–‹ãã¾ã™</p>
    <button id="searchWidgetTrigger" style="padding: 15px 30px; background-color: #4285f4; color: white; border: none; border-radius: 30px; font-weight: bold; cursor: pointer;">
        AIãƒãƒ£ãƒƒãƒˆã‚’èµ·å‹•ã™ã‚‹
    </button>
    <br>
    <button id="voice-btn" title="éŸ³å£°ã§å…¥åŠ›">ğŸ™ï¸</button>
    <p id="status" style="font-size: 12px; color: #666; margin-top: 10px;">ãƒã‚¤ã‚¯ã‚’æŠ¼ã—ã¦å–‹ã£ã¦ãã ã•ã„</p>
</div>

<gen-search-widget
  configId="641e8208-ac63-4d51-a816-f864dfd00f27"
  triggerId="searchWidgetTrigger"
  max-results="1"
  enable-source-grounding="true"
  auth-type="public">
</gen-search-widget>

<script src="https://cloud.google.com/ai/gen-app-builder/client?hl=ja"></script>

<script>
    // ãƒ–ãƒ©ã‚¦ã‚¶ã®éŸ³å£°èªè­˜æ©Ÿèƒ½ï¼ˆWeb Speech APIï¼‰ã‚’å‘¼ã³å‡ºã™è¨­å®š
    const voiceBtn = document.getElementById('voice-btn');
    const statusText = document.getElementById('status');
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    if (!SpeechRecognition) {
        statusText.innerText = "ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯éŸ³å£°å…¥åŠ›ã«å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“";
        voiceBtn.style.display = "none";
    } else {
        const recognition = new SpeechRecognition();
        recognition.lang = 'ja-JP';

        voiceBtn.onclick = () => {
            recognition.start();
            voiceBtn.classList.add('recording');
            statusText.innerText = "èãå–ã‚Šä¸­...";
        };

        recognition.onresult = (event) => {
            const transcript = event.results[0][0].transcript;
            voiceBtn.classList.remove('recording');
            statusText.innerText = "ã€Œ" + transcript + "ã€ã§æ¤œç´¢ä¸­...";
            
            // ğŸ™ï¸ èãå–ã£ãŸè¨€è‘‰ã‚’Googleã®æ¤œç´¢çª“ã«ç„¡ç†ã‚„ã‚Šæµã—è¾¼ã‚“ã§å®Ÿè¡Œã™ã‚‹
            const searchInput = document.querySelector('input[type="search"]') || document.getElementById('search-widget-input');
            if (searchInput) {
                searchInput.value = transcript;
                searchInput.dispatchEvent(new Event('input', { bubbles: true }));
                searchInput.dispatchEvent(new Event('keydown', { key: 'Enter', bubbles: true }));
            }
            
            // ãƒãƒ£ãƒƒãƒˆã‚’è‡ªå‹•èµ·å‹•
            document.getElementById('searchWidgetTrigger').click();
        };

        recognition.onerror = () => {
            voiceBtn.classList.remove('recording');
            statusText.innerText = "ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚‚ã†ä¸€åº¦è©¦ã—ã¦ãã ã•ã„";
        };
    }
</script>

</body>
</html>
